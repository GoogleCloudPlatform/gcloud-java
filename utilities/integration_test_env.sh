# Remove orphaned firewall rules and networks presumed generated by interrupted runs of Compute
# integration tests: see https://github.com/GoogleCloudPlatform/google-cloud-java/issues/2118
firewalls=$(gcloud compute firewall-rules list | cut -f 1 -d ' ' | grep '^test-')
if [[ $firewalls ]]
then
  echo 'Y' | gcloud compute firewall-rules delete $firewalls
fi
networks=$(gcloud compute networks list | cut -f 1 -d ' ' | grep '^test-')
if [[ $networks ]]
then
  echo 'Y' | gcloud compute networks delete $networks
fi

# Export test env variables
export GCLOUD_PROJECT="gcloud-devel"
export GOOGLE_APPLICATION_CREDENTIALS=$TRAVIS_BUILD_DIR/signing-tools/gcloud-devel-travis.json
export GOOGLE_API_KEY=$(< $TRAVIS_BUILD_DIR/signing-tools/api_key)
